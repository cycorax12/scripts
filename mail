SELECT TO_CHAR(minute_window, 'DD-MON-YYYY HH:MI:SS AM') AS minute_window,
       rows_updated
FROM (
    SELECT 
        TRUNC(LAST_UPDATED_TIME, 'MI') AS minute_window,
        COUNT(*) AS rows_updated
    FROM settlement_detail
    WHERE LAST_UPDATED_TIME >= ADD_MONTHS(TRUNC(SYSDATE), -1)
    GROUP BY TRUNC(LAST_UPDATED_TIME, 'MI')
    ORDER BY rows_updated DESC
)
WHERE ROWNUM = 1;
