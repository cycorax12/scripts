SELECT MAX(rows_updated) AS max_rows_per_minute
FROM (
    SELECT 
        TRUNC(LAST_UPDATED_TIME, 'MI') AS minute_window,
        COUNT(*) AS rows_updated
    FROM settlement_detail
    WHERE LAST_UPDATED_TIME >= TO_DATE('2025-08-07 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
      AND LAST_UPDATED_TIME <  TO_DATE('2025-08-08 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
    GROUP BY TRUNC(LAST_UPDATED_TIME, 'MI')
);
